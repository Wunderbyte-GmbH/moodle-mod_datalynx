{"version":3,"file":"coursegroup.min.js","sources":["../src/coursegroup.js"],"sourcesContent":["export default {\n    init(options) {\n      const {coursefield, groupfield, acturl: actionurl} = options;\n      // Update input field with the selected group id\n      document.getElementById(`id_${groupfield}`).addEventListener('change', function() {\n        const selectedValue = document.querySelector(`#id_${groupfield} option:checked`).value;\n        document.getElementById(`id_${groupfield}id`).value = selectedValue;\n      });\n      // When the course is changed, fetch groups using AJAX\n      document.getElementById(`id_${coursefield}`).addEventListener('change', function() {\n        const groupSelect = document.getElementById(`id_${groupfield}`);\n        const selectedCourseId = document.querySelector(`#id_${coursefield} option:checked`).value;\n        // Remove current options\n        groupSelect.innerHTML = '';\n        // Load groups for selected course\n        if (selectedCourseId !== '0') {\n          // Fetch groups via fetch API\n          return fetch(actionurl, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            body: `courseid=${selectedCourseId}`\n          })\n          .then(response => {\n            // Return the response text to the next .then()\n            return response.text();\n          })\n          .then(data => {\n            if (data) {\n              // Populate group options\n              data.split(',').forEach(group => {\n                const value = group.split(' ', 1)[0];\n                const option = document.createElement('option');\n                option.value = value;\n                option.textContent = group;\n                groupSelect.appendChild(option);\n              });\n            }\n            // Return null if there's nothing further to do\n            return null;\n          })\n          .catch(() => {\n            throw new Error('Group loading failed');\n          });\n        } else {\n          return Promise.resolve(); // Return a resolved promise if no action is needed\n        }\n      });\n    }\n  };"],"names":["init","options","coursefield","groupfield","acturl","actionurl","document","getElementById","addEventListener","selectedValue","querySelector","value","groupSelect","selectedCourseId","innerHTML","fetch","method","headers","body","then","response","text","data","split","forEach","group","option","createElement","textContent","appendChild","catch","Error","Promise","resolve"],"mappings":"+JAAe,CACXA,KAAKC,eACGC,YAACA,YAADC,WAAcA,WAAYC,OAAQC,WAAaJ,QAErDK,SAASC,4BAAqBJ,aAAcK,iBAAiB,UAAU,iBAC/DC,cAAgBH,SAASI,4BAAqBP,+BAA6BQ,MACjFL,SAASC,4BAAqBJ,kBAAgBQ,MAAQF,iBAGxDH,SAASC,4BAAqBL,cAAeM,iBAAiB,UAAU,iBAChEI,YAAcN,SAASC,4BAAqBJ,aAC5CU,iBAAmBP,SAASI,4BAAqBR,gCAA8BS,aAErFC,YAAYE,UAAY,GAEC,MAArBD,iBAEKE,MAAMV,UAAW,CACtBW,OAAQ,OACRC,QAAS,gBACS,qCAElBC,wBAAkBL,oBAEnBM,MAAKC,UAEGA,SAASC,SAEjBF,MAAKG,OACAA,MAEFA,KAAKC,MAAM,KAAKC,SAAQC,cAChBd,MAAQc,MAAMF,MAAM,IAAK,GAAG,GAC5BG,OAASpB,SAASqB,cAAc,UACtCD,OAAOf,MAAQA,MACfe,OAAOE,YAAcH,MACrBb,YAAYiB,YAAYH,WAIrB,QAERI,OAAM,WACC,IAAIC,MAAM,2BAGXC,QAAQC"}