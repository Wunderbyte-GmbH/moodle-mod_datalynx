define("mod_datalynx/fieldgroups",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;var _default={init(fieldgroupname,defaultlines,maxlines,requiredlines,fieldgroup){for(let line=++defaultlines;line<=maxlines;line++)document.querySelectorAll("div[data-field-name='".concat(fieldgroupname,"'] [data-line='").concat(line,"']")).forEach((element=>{element.style.display="none"}));document.querySelectorAll("div.datalynx-field-wrapper #id_addline").forEach((button=>{button.addEventListener("click",(e=>{e.preventDefault();const firstHiddenLine=button.closest(".datalynx-field-wrapper").querySelector("[data-line]:not([style*='display: none'])");firstHiddenLine&&(firstHiddenLine.style.display="");const lastVisibleInput=document.querySelector("input[name='".concat(fieldgroup,"_lastvisible']"));parseInt(lastVisibleInput.value,10)<maxlines&&(lastVisibleInput.value=parseInt(lastVisibleInput.value,10)+1)}))})),document.querySelectorAll("div[data-field-name='".concat(fieldgroupname,"'] [data-removeline]")).forEach((removeButton=>{removeButton.removeEventListener("click",this.handleRemoveLine),removeButton.addEventListener("click",this.handleRemoveLine.bind(this,removeButton,fieldgroupname,maxlines,requiredlines,fieldgroup))}))},handleRemoveLine(removeButton,fieldgroupname,maxlines,requiredlines,fieldgroup,e){e.preventDefault();const thisLine=removeButton.closest(".lines"),lineId=parseInt(thisLine.dataset.line,10),parentContainer=thisLine.closest(".datalynx-field-wrapper"),lastVisibleLine=Array.from(parentContainer.querySelectorAll(".lines")).reverse().find((line=>"none"!==line.style.display)),lastVisibleLineId=parseInt(lastVisibleLine.dataset.line,10);thisLine.querySelectorAll(".fp-file").forEach((file=>{var _document$querySelect,_document$querySelect2;file.click(),null===(_document$querySelect=document.querySelector(".fp-file-delete:visible"))||void 0===_document$querySelect||_document$querySelect.click(),null===(_document$querySelect2=document.querySelector(".fp-dlg-butconfirm:visible"))||void 0===_document$querySelect2||_document$querySelect2.click()})),thisLine.querySelectorAll("input").forEach((input=>{"hidden"!==input.type&&(input.value="")})),thisLine.querySelectorAll(".editor_atto_content").forEach((editor=>{editor.innerHTML=""})),thisLine.querySelectorAll("textarea").forEach((textarea=>{textarea.value=""})),thisLine.querySelectorAll("select").forEach((select=>{select.querySelector('option[value=""]').selected=!0})),thisLine.querySelectorAll("[id$=enabled]:checked, .form-autocomplete-selection .tag").forEach((element=>{element.click()}));const lastVisibleInput=document.querySelector("input[name='".concat(fieldgroup,"_lastvisible']"));if(lastVisibleInput.value=parseInt(lastVisibleInput.value,10)-1,lineId>requiredlines&&lineId>=1){thisLine.style.display="none",lineId!==maxlines&&parentContainer.querySelectorAll("[data-line]").forEach((line=>{const currentLineId=parseInt(line.dataset.line,10);currentLineId>lineId&&currentLineId<=lastVisibleLineId?line.dataset.line=currentLineId-1:currentLineId===lineId&&(line.dataset.line=lastVisibleLineId)}));const newContentOrder=[];parentContainer.querySelectorAll("[data-line]").forEach((line=>{newContentOrder[line.dataset.line]=line})),parentContainer.innerHTML="",newContentOrder.reverse().forEach((line=>{line&&parentContainer.appendChild(line)}))}}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=fieldgroups.min.js.map