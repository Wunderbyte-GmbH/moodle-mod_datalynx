define(["jquery"],function(a){return{init:function(b,c,d,e,f){c++;for(var g=c;g<=d;g++)a("div[data-field-name='"+b+"'] [data-line='"+g+"']").hide();a("div.datalynx-field-wrapper #id_addline").click(function(b){b.preventDefault(),a(this).closest(".datalynx-field-wrapper").find("[data-line]:hidden:first").show(),a("input[name="+f+"_lastvisible]").val()<d&&a("input[name="+f+"_lastvisible]").get(0).value++}),a("div[data-field-name='"+b+"'] [data-removeline]").each(function(){a(this).off("click"),a(this).click(function(b){b.preventDefault();var c=a(this).closest(".lines"),g=c.data("line"),h=c.closest(".datalynx-field-wrapper"),i=h.find(".lines:visible").last(),j=i.data("line");if(c.find(".fp-file").each(function(){a(this).click(),a(".fp-file-delete:visible").trigger("click"),a(".fp-dlg-butconfirm:visible").trigger("click")}),a(this).closest(".lines").find("input").each(function(){"hidden"!=a(this).attr("type")&&a(this).val("")}),a(this).closest(".lines").find(".editor_atto_content").each(function(){a(this).html("")}),a(this).closest(".lines").find("textarea").each(function(){a(this).val("")}),a(this).closest(".lines").find("select").each(function(){a(this).find('option[value=""]').prop("selected",!0)}),a(this).closest(".lines").find("[id$=enabled]:checked, .form-autocomplete-selection .tag").each(function(){a(this).trigger("click")}),a("input[name="+f+"_lastvisible]").get(0).value--,g>e&&g>=1){c.hide(),g!=d&&h.find("[data-line]").each(function(){if(a(this).data("line")>g&&a(this).data("line")<=j){var b=a(this).data("line")-1;a(this).attr("data-line",b)}a(this).data("line")==g&&a(this).attr("data-line",j)});var k=[];h.find("[data-line]").each(function(){k[a(this).data("line")]=a(this)}),h.remove(".lines");for(var l=k.length;l>=0;l--)h.prepend(k[l])}})})}}});