function reInitializeButtons(editor){editor.getBody().querySelectorAll('button[data-action-tag-button="true"], button.datalynx-field-tag').forEach((button=>{button.getAttribute("data-click-initialized")||(button.addEventListener("click",(()=>function(button){const isFieldTag=button.classList.contains("datalynx-field-tag"),dialogContent=document.createElement("div");dialogContent.setAttribute("id",button.getAttribute("data-id")),dialogContent.innerHTML=isFieldTag?"\n            <p>Field tag properties:</p>\n            <p>Field: ".concat(button.textContent,'</p>\n            <label>Behavior:</label>\n            <select id="tag-behavior-select-').concat(dialogContent.id,'">\n                <option value="behavior1">Behavior 1</option>\n                <option value="behavior2">Behavior 2</option>\n            </select>\n            <label>Renderer:</label>\n            <select id="tag-renderer-select-').concat(dialogContent.id,'">\n                <option value="renderer1">Renderer 1</option>\n                <option value="renderer2">Renderer 2</option>\n            </select>\n            <button type="button" class="delete-tag">Delete tag</button>\n        '):"\n            <p>Action tag properties:</p>\n            <p>Action: ".concat(button.textContent,'</p>\n            <button type="button" class="delete-tag">Delete tag</button>\n        ');dialogContent.querySelectorAll(".delete-tag").forEach((deleteButton=>{deleteButton.addEventListener("click",(()=>{button.remove(),dialog.hide()}))}));const dialog=new M.core.dialogue({bodyContent:dialogContent,width:"400px",draggable:!0,modal:!0,visible:!0,footerContent:""})}(button))),button.setAttribute("data-click-initialized","true"),button.setAttribute("data-id","datalynx-buton-id-0"))}))}function initializeTinyMCEButtons(){var _window$tinyMCE;null!==(_window$tinyMCE=window.tinyMCE)&&void 0!==_window$tinyMCE&&_window$tinyMCE.get?window.tinyMCE.get().forEach((editor=>{editor.on("init",(()=>reInitializeButtons(editor))),editor.on("SetContent",(()=>reInitializeButtons(editor))),editor.on("change",(()=>reInitializeButtons(editor)))})):setTimeout(initializeTinyMCEButtons,100)}function initReplaceTagsWithButtons(){window.tinyMCE.get().forEach((editor=>{editor.on("init",(()=>function(editor){const content=editor.getContent(),div=document.createElement("div");div.innerHTML=content,div.innerHTML=div.innerHTML.replace(/##([^#]+)##/g,((match,action)=>'<button type="button" contenteditable="false" data-action-tag-button="true"\n        data-datalynx-field="'.concat(action,'">').concat(action,"</button>"))),div.innerHTML=div.innerHTML.replace(/\[\[([^\|\]]+)(?:\|([^\|\]]*))?(?:\|([^\|\]]*))?\]\]/g,((match,field,behavior,renderer)=>(behavior=behavior||"",renderer=renderer||"",'<button type="button" contenteditable="false" class="datalynx-field-tag" data-datalynx-field="\n        '.concat(field,'" data-datalynx-behavior="').concat(behavior,'" data-datalynx-renderer="').concat(renderer,'">').concat(field,"</button>")))),editor.setContent(div.innerHTML)}(editor))),editor.on("SetContent",(()=>reInitializeButtons(editor))),editor.on("change",(()=>reInitializeButtons(editor)))}))}function waitForTinyMCE(){var _window$tinyMCE2;null!==(_window$tinyMCE2=window.tinyMCE)&&void 0!==_window$tinyMCE2&&_window$tinyMCE2.activeEditor&&window.tinyMCE.get().length>0?(initReplaceTagsWithButtons(),initializeTinyMCEButtons()):setTimeout(waitForTinyMCE,100)}document.addEventListener("DOMContentLoaded",(()=>{const dropdownMenu=document.getElementById("eparam2_editor_field_tag_menu");"undefined"!=typeof tinymce?waitForTinyMCE():document.addEventListener("tinymce-editor-init",waitForTinyMCE),dropdownMenu&&dropdownMenu.addEventListener("change",(()=>{const selectedValue=dropdownMenu.value,actionTagMatch=selectedValue.match(/^##(.+?)##$/),fieldTagMatch=selectedValue.match(/^\[\[([^\|\]]+)(?:\|([^\|\]]*))?(?:\|([^\|\]]*))?\]\]$/);let contentToInsert="";if(actionTagMatch)contentToInsert='<button type="button" contenteditable="false" class="action-tag-button"\n                data-action-tag-button="true" data-datalynx-field="'.concat(actionTagMatch[1],'">').concat(actionTagMatch[1],"</button>");else if(fieldTagMatch){const field=fieldTagMatch[1],behavior=fieldTagMatch[2]||"",renderer=fieldTagMatch[3]||"";contentToInsert='<button type="button" contenteditable="false" class="datalynx-field-tag" \n                data-datalynx-field="'.concat(field,'" data-datalynx-behavior="').concat(behavior,'" \n                data-datalynx-renderer="').concat(renderer,'">').concat(field,"</button>")}else contentToInsert=selectedValue;window.tinyMCE.get().forEach((editor=>{"id_eparam2_editor"===editor.id&&(editor.insertContent(contentToInsert),reInitializeButtons(editor))}))}));document.querySelector("#datalynx-view-edit-form").addEventListener("submit",(event=>{window.tinyMCE.get().forEach((editor=>{const content=editor.getContent(),div=document.createElement("div");div.innerHTML=content,div.querySelectorAll('button[data-action-tag-button="true"]').forEach((button=>{const action=button.getAttribute("data-datalynx-field");button.replaceWith("##".concat(action,"##"))})),div.querySelectorAll("button.datalynx-field-tag").forEach((button=>{const field=button.getAttribute("data-datalynx-field").trim(),behavior=button.getAttribute("data-datalynx-behavior")||"",renderer=button.getAttribute("data-datalynx-renderer")||"",rawFieldTag="[[".concat(field).concat(behavior?"|"+behavior:"").concat(renderer?"|"+renderer:"","]]");button.replaceWith(rawFieldTag)})),editor.setContent(div.innerHTML)}))}))})),waitForTinyMCE();

//# sourceMappingURL=patterndialogue.min.js.map