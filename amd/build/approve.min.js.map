{"version":3,"file":"approve.min.js","sources":["../src/approve.js"],"sourcesContent":["define(['jquery'], function($) {\n\n    return {\n        init: function(approvedicon, disapprovedicon) {\n            // After initialisation we loop through all links for subscribe / unsubscribe.\n            $( \".datalynxfield__approve\" ).each(function () {\n                var href = this.href;\n                var params = extractParams(href.split('?')[1]);\n\n                    $(this).off( \"click\" );\n                    $(this).click(function(e) {\n                        e.preventDefault(); // Don't follow hrefs.\n                        // AJAX call\n                        var actionurl = \"field/_approve/ajax.php\";\n                        $.ajax(\n                            {\n                                method: \"POST\",\n                                url: actionurl,\n                                data: params,\n                                context: this,\n                                success: function(data) {\n                                    if (data && $(this).children().hasClass('approved')) {\n                                        $(this).children().removeClass('approved');\n                                        $(this).children().prop('src', disapprovedicon);\n                                        $(this).children().prop('alt', 'approve');\n                                        $(this).children().prop('title', 'approve');\n                                        params.action = 'approve';\n                                    } else if (data && !$(this).children().hasClass('approved')) {\n                                        $(this).children().addClass('approved');\n                                        $(this).children().prop('src', approvedicon);\n                                        $(this).children().prop('alt', 'disapprove');\n                                        $(this).children().prop('title', 'disapprove');\n                                        params.action = 'disapprove';\n                                    }\n                                },\n                            }\n                        );\n                });\n\n            });\n\n            /**\n             * Extract params.\n             *\n             * @param {string} paramstring\n             * @returns {{}}\n             */\n            function extractParams(paramstring) {\n                let params = paramstring.split(\"&\");\n                let output = {}; // Create an object.\n                for (var i = 0; i < params.length; i++) {\n                    var param = params[i];\n                    output[param.split(\"=\")[0]] = param.split(\"=\")[1];\n                }\n                if ('approve' in output) {\n                    output.entryid = output.approve;\n                    output.action = 'approve';\n                } else if ('disapprove' in output) {\n                    output.entryid = output.disapprove;\n                    output.action = 'disapprove';\n                } else {\n                    output.entryid = output.approve;\n                    output.action = 'approve';\n                }\n                return output;\n            }\n        }\n    };\n});\n"],"names":["define","$","init","approvedicon","disapprovedicon","each","params","paramstring","split","output","i","length","param","entryid","approve","action","disapprove","extractParams","this","href","off","click","e","preventDefault","ajax","method","url","data","context","success","children","hasClass","removeClass","prop","addClass"],"mappings":"AAAAA,8BAAO,CAAC,WAAW,SAASC,SAEjB,CACHC,KAAM,SAASC,aAAcC,iBAEzBH,EAAG,2BAA4BI,MAAK,eAE5BC,gBAwCeC,iBACfD,OAASC,YAAYC,MAAM,KAC3BC,OAAS,OACR,IAAIC,EAAI,EAAGA,EAAIJ,OAAOK,OAAQD,IAAK,KAChCE,MAAQN,OAAOI,GACnBD,OAAOG,MAAMJ,MAAM,KAAK,IAAMI,MAAMJ,MAAM,KAAK,GAE/C,YAAaC,QACbA,OAAOI,QAAUJ,OAAOK,QACxBL,OAAOM,OAAS,WACT,eAAgBN,QACvBA,OAAOI,QAAUJ,OAAOO,WACxBP,OAAOM,OAAS,eAEhBN,OAAOI,QAAUJ,OAAOK,QACxBL,OAAOM,OAAS,kBAEbN,OAzDMQ,CADFC,KAAKC,KACgBX,MAAM,KAAK,IAEvCP,EAAEiB,MAAME,IAAK,SACbnB,EAAEiB,MAAMG,OAAM,SAASC,GACnBA,EAAEC,iBAGFtB,EAAEuB,KACE,CACIC,OAAQ,OACRC,IAJQ,0BAKRC,KAAMrB,OACNsB,QAASV,KACTW,QAAS,SAASF,MACVA,MAAQ1B,EAAEiB,MAAMY,WAAWC,SAAS,aACpC9B,EAAEiB,MAAMY,WAAWE,YAAY,YAC/B/B,EAAEiB,MAAMY,WAAWG,KAAK,MAAO7B,iBAC/BH,EAAEiB,MAAMY,WAAWG,KAAK,MAAO,WAC/BhC,EAAEiB,MAAMY,WAAWG,KAAK,QAAS,WACjC3B,OAAOS,OAAS,WACTY,OAAS1B,EAAEiB,MAAMY,WAAWC,SAAS,cAC5C9B,EAAEiB,MAAMY,WAAWI,SAAS,YAC5BjC,EAAEiB,MAAMY,WAAWG,KAAK,MAAO9B,cAC/BF,EAAEiB,MAAMY,WAAWG,KAAK,MAAO,cAC/BhC,EAAEiB,MAAMY,WAAWG,KAAK,QAAS,cACjC3B,OAAOS,OAAS"}