define("mod_datalynx/teammemberselect",["jquery"],(function($){return{init:function(fieldid,userurl,username,canunsubscribe){function extractParams(paramstring){for(var params=paramstring.split("&"),output={},i=0;i<params.length;i++){var param=params[i];output[param.split("=")[0]]=param.split("=")[1]}return output}$("a.datalynxfield_subscribe").each((function(){var params=extractParams($(this).attr("href").split("?")[1]);params.fieldid===fieldid&&(params.ajax=!0,$("a.datalynxfield_subscribe").off("click"),$("a.datalynxfield_subscribe").click((function(e){e.preventDefault(),$(this).prev("ul").length||$(this).before("<ul></ul>");var ul=$(this).prev("ul");$.ajax({method:"POST",url:"field/teammemberselect/ajax.php",data:params,context:this,dataType:"json",success:function(data){var listelement,userurlparams;data&&$(this).hasClass("subscribed")?(canunsubscribe&&($(this).toggleClass("subscribed"),$(this).prop("title","Eintragen"),$(this).prop("innerHTML","Eintragen"),params.action="subscribe",$(this).prop("href",$(this).prop("href").replace("unsubscribe","subscribe"))),listelement=ul,userurlparams=extractParams(userurl.split("?")[1]),$(listelement).find("li").find("a").each((function(idx,li){var anchorparams=extractParams($(li).prop("href").split("?")[1]);userurlparams.id==anchorparams.id&&$(li).parent().remove()})),0==listelement.children().length&&listelement.remove()):data&&!$(this).hasClass("subscribed")&&($(this).toggleClass("subscribed"),$(this).prop("title","Austragen"),$(this).prop("innerHTML","Austragen"),params.action="unsubscribe",$(this).prop("href",$(this).prop("href").replace("subscribe","unsubscribe")),ul.append("<li><a href="+userurl+">"+username+"</a></li>"))}})})))}))}}}));

//# sourceMappingURL=teammemberselect.min.js.map