{"version":3,"file":"behavior.min.js","sources":["../src/behavior.js"],"sourcesContent":["export default {\n    init() {\n        document.querySelectorAll('img[data-for]').forEach((img) => {\n            img.addEventListener(\"click\", (event) => {\n                const clickedImg = event.target;\n                const behaviorid = clickedImg.getAttribute('data-behavior-id');\n                const permissionid = clickedImg.getAttribute('data-permission-id');\n                const forproperty = clickedImg.getAttribute('data-for');\n                const sesskey = document.querySelector('table.datalynx-behaviors')?.getAttribute('data-sesskey') || M.cfg.sesskey;\n                const actionurl = \"behavior_edit_ajax.php\";\n\n                // Construct the object\n                const obj = {\n                    behaviorid,\n                    permissionid,\n                    forproperty,\n                    sesskey\n                };\n\n                // Serialize the object to a query string\n                const list = Object.keys(obj).map((k) => {\n                    const encodedKey = encodeURIComponent(k);\n                    const value = obj[k];\n                    if (Array.isArray(value)) {\n                        return value.map(v => `${encodedKey}[]=${encodeURIComponent(v)}`).join('&');\n                    } else {\n                        return `${encodedKey}=${encodeURIComponent(value)}`;\n                    }\n                }).join('&');\n\n                // Create an AbortController to implement timeout\n                const controller = new AbortController();\n                const timeoutId = setTimeout(() => controller.abort(), 5000);\n\n                // Fetch API request with abort signal\n                fetch(actionurl, {\n                    method: \"POST\",\n                    headers: {\n                        'Content-Type': 'application/x-www-form-urlencoded'\n                    },\n                    body: list,\n                    signal: controller.signal\n                })\n                .then(response => {\n                    clearTimeout(timeoutId);\n                    return response.text();  // Ensure that you return the result of response.text()\n                })\n                .then(data => {\n                    if (data !== '') {\n                        let src = clickedImg.getAttribute(\"src\");\n                        if (src.includes(\"-enabled\")) {\n                            src = src.replace(\"-enabled\", \"-n\");\n                        } else if (src.includes(\"-n\")) {\n                            src = src.replace(\"-n\", \"-enabled\");\n                        }\n                        clickedImg.setAttribute(\"src\", src);\n                    }\n                    return true; // Return a value to satisfy the ESLint rule\n                })\n                .catch((err) => {\n                    throw err;\n                });\n            });\n        });\n    }\n};\n"],"names":["init","document","querySelectorAll","forEach","img","addEventListener","event","clickedImg","target","obj","behaviorid","getAttribute","permissionid","forproperty","sesskey","querySelector","M","cfg","list","Object","keys","map","k","encodedKey","encodeURIComponent","value","Array","isArray","v","join","controller","AbortController","timeoutId","setTimeout","abort","fetch","method","headers","body","signal","then","response","clearTimeout","text","data","src","includes","replace","setAttribute","catch","err"],"mappings":"4JAAe,CACXA,OACIC,SAASC,iBAAiB,iBAAiBC,SAASC,MAChDA,IAAIC,iBAAiB,SAAUC,wCACrBC,WAAaD,MAAME,OAQnBC,IAAM,CACRC,WAReH,WAAWI,aAAa,oBASvCC,aARiBL,WAAWI,aAAa,sBASzCE,YARgBN,WAAWI,aAAa,YASxCG,uCARYb,SAASc,cAAc,0FAA6BJ,aAAa,kBAAmBK,EAAEC,IAAIH,SAYpGI,KAAOC,OAAOC,KAAKX,KAAKY,KAAKC,UACzBC,WAAaC,mBAAmBF,GAChCG,MAAQhB,IAAIa,UACdI,MAAMC,QAAQF,OACPA,MAAMJ,KAAIO,aAAQL,yBAAgBC,mBAAmBI,MAAMC,KAAK,eAE7DN,uBAAcC,mBAAmBC,WAEhDI,KAAK,KAGFC,WAAa,IAAIC,gBACjBC,UAAYC,YAAW,IAAMH,WAAWI,SAAS,KAGvDC,MA1BkB,yBA0BD,CACbC,OAAQ,OACRC,QAAS,gBACW,qCAEpBC,KAAMpB,KACNqB,OAAQT,WAAWS,SAEtBC,MAAKC,WACFC,aAAaV,WACNS,SAASE,UAEnBH,MAAKI,UACW,KAATA,KAAa,KACTC,IAAMtC,WAAWI,aAAa,OAC9BkC,IAAIC,SAAS,YACbD,IAAMA,IAAIE,QAAQ,WAAY,MACvBF,IAAIC,SAAS,QACpBD,IAAMA,IAAIE,QAAQ,KAAM,aAE5BxC,WAAWyC,aAAa,MAAOH,YAE5B,KAEVI,OAAOC,YACEA"}