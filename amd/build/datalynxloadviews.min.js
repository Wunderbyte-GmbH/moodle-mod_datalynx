define("mod_datalynx/datalynxloadviews",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;var _default={init(options){const{dffield:dffield,viewfield:viewfield,textfieldfield:textfieldfield,acturl:actionurl,presentdlid:presentdlid,thisfieldstring:thisfieldstring,update:update,fieldtype:fieldtype}=options,dffieldElement=document.getElementById("id_".concat(dffield)),viewElement=document.getElementById("id_".concat(viewfield)),textfieldElement=document.getElementById("id_".concat(textfieldfield));dffieldElement&&dffieldElement.addEventListener("change",(function(){const dfid=this.value;return viewElement&&(viewElement.innerHTML=""),textfieldElement&&(textfieldElement.innerHTML=""),0!=dfid?fetch(actionurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"dfid=".concat(dfid)}).then((response=>{if(!response.ok)throw new Error("Network response was not ok");return response.text()})).then((data=>{if(""!==data){const respoptions=data.split("#");if(viewElement){respoptions[0].split(",").forEach((option=>{const[qid,...qnameArr]=option.trim().split(" "),qname=qnameArr.join(" "),optionElement=document.createElement("option");optionElement.value=qid,optionElement.textContent=qname,viewElement.appendChild(optionElement)}))}if(textfieldElement){const textfieldoptions=respoptions[1].split(",");if(dfid==presentdlid&&0===update&&"text"===fieldtype){const optionElement=document.createElement("option");optionElement.value="-1",optionElement.textContent=thisfieldstring,textfieldElement.appendChild(optionElement)}textfieldoptions.forEach((option=>{const[qid,...qnameArr]=option.trim().split(" "),qname=qnameArr.join(" "),optionElement=document.createElement("option");optionElement.value=qid,optionElement.textContent=qname,textfieldElement.appendChild(optionElement)}))}}return data})).catch((()=>{throw new Error("Error while loading views and textfields.")})):void 0}))}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=datalynxloadviews.min.js.map